#!/usr/bin/env node
(()=>{var e,t={5285:(e,t,r)=>{var n=r(5173),o=n.FileSystem.require(),s=r(5622);o.existsSync=o.existsSync||s.existsSync;var i=r(7396),a=r(6333);/^win/.test(process.platform),e.exports=function(e){var t=void 0,r="";if(e&&"string"==typeof e){if(!o.existsSync(e))throw new Error(n.Errors.INVALID_FILENAME);r=e,t=new a(e,n.Constants.FILE)}else t=e&&Buffer.isBuffer(e)?new a(e,n.Constants.BUFFER):new a(null,n.Constants.NONE);function c(e,t){e=s.resolve(s.normalize(e));for(var r=t.split("/"),n=0,o=r.length;n<o;n++){var i=s.normalize(s.join(e,r.slice(n,o).join(s.sep)));if(0===i.indexOf(e))return i}return s.normalize(s.join(e,s.basename(t)))}function l(e){var r;return e&&t&&("string"==typeof e&&(r=t.getEntry(e)),"object"==typeof e&&void 0!==e.entryName&&void 0!==e.header&&(r=t.getEntry(e.entryName)),r)?r:null}return{readFile:function(e){var t=l(e);return t&&t.getData()||null},readFileAsync:function(e,t){var r=l(e);r?r.getDataAsync(t):t(null,"getEntry failed for:"+e)},readAsText:function(e,t){var r=l(e);if(r){var n=r.getData();if(n&&n.length)return n.toString(t||"utf8")}return""},readAsTextAsync:function(e,t,r){var n=l(e);n?n.getDataAsync((function(e,n){n?t(e,n):e&&e.length?t(e.toString(r||"utf8")):t("")})):t("")},deleteFile:function(e){var r=l(e);r&&t.deleteEntry(r.entryName)},addZipComment:function(e){t.comment=e},getZipComment:function(){return t.comment||""},addZipEntryComment:function(e,t){var r=l(e);r&&(r.comment=t)},getZipEntryComment:function(e){var t=l(e);return t&&t.comment||""},updateFile:function(e,t){var r=l(e);r&&r.setData(t)},addLocalFile:function(e,t,r){if(!o.existsSync(e))throw new Error(n.Errors.FILE_NOT_FOUND.replace("%s",e));t?"/"!==(t=t.split("\\").join("/")).charAt(t.length-1)&&(t+="/"):t="";var s=e.split("\\").join("/").split("/").pop();r?this.addFile(t+r,o.readFileSync(e),"",0):this.addFile(t+s,o.readFileSync(e),"",0)},addLocalFolder:function(e,t,r){if(void 0===r?r=function(){return!0}:r instanceof RegExp&&(r=function(e){return function(t){return e.test(t)}}(r)),t?"/"!==(t=t.split("\\").join("/")).charAt(t.length-1)&&(t+="/"):t="","/"!==(e=(e=s.normalize(e)).split("\\").join("/")).charAt(e.length-1)&&(e+="/"),!o.existsSync(e))throw new Error(n.Errors.FILE_NOT_FOUND.replace("%s",e));var i=n.findFiles(e),a=this;i.length&&i.forEach((function(n){var s=n.split("\\").join("/").replace(new RegExp(e.replace(/(\(|\)|\$)/g,"\\$1"),"i"),"");r(s)&&("/"!==s.charAt(s.length-1)?a.addFile(t+s,o.readFileSync(n),"",0):a.addFile(t+s,Buffer.alloc(0),"",0))}))},addLocalFolderAsync:function(e,t,r,i){void 0===i?i=function(){return!0}:i instanceof RegExp&&(i=function(e){return function(t){return e.test(t)}}(i)),r?"/"!==(r=r.split("\\").join("/")).charAt(r.length-1)&&(r+="/"):r="","/"!==(e=(e=s.normalize(e)).split("\\").join("/")).charAt(e.length-1)&&(e+="/");var a=this;o.open(e,"r",(function(s,c){if(s&&"ENOENT"===s.code)t(void 0,n.Errors.FILE_NOT_FOUND.replace("%s",e));else if(s)t(void 0,s);else{var l=n.findFiles(e),f=-1,h=function(){if((f+=1)<l.length){var n=l[f].split("\\").join("/").replace(new RegExp(e.replace(/(\(|\))/g,"\\$1"),"i"),"");n=n.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^\x20-\x7E]/g,""),i(n)?"/"!==n.charAt(n.length-1)?o.readFile(l[f],(function(e,o){e?t(void 0,e):(a.addFile(r+n,o,"",0),h())})):(a.addFile(r+n,Buffer.alloc(0),"",0),h()):h()}else t(!0,void 0)};h()}}))},addFile:function(e,r,n,o){var s=new i;s.entryName=e,s.comment=n||"",o||(o=s.isDirectory?1106051088:420<<16),s.attr=o,s.setData(r),t.setEntry(s)},getEntries:function(){return t?t.entries:[]},getEntry:function(e){return l(e)},getEntryCount:function(){return t.getEntryCount()},forEach:function(e){return t.forEach(e)},extractEntryTo:function(e,r,i,a){a=a||!1,i=void 0===i||i;var f=l(e);if(!f)throw new Error(n.Errors.NO_ENTRY);var h=f.entryName,u=c(r,i?h:s.basename(h));if(f.isDirectory)return u=s.resolve(u,".."),t.getEntryChildren(f).forEach((function(e){if(!e.isDirectory){var t=e.getData();if(!t)throw new Error(n.Errors.CANT_EXTRACT_FILE);var o=c(r,i?e.entryName:s.basename(e.entryName));n.writeFileTo(o,t,a)}})),!0;var d=f.getData();if(!d)throw new Error(n.Errors.CANT_EXTRACT_FILE);if(o.existsSync(u)&&!a)throw new Error(n.Errors.CANT_OVERRIDE);return n.writeFileTo(u,d,a),!0},test:function(){if(!t)return!1;for(var e in t.entries)try{if(e.isDirectory)continue;if(!t.entries[e].getData())return!1}catch(e){return!1}return!0},extractAllTo:function(e,r){if(r=r||!1,!t)throw new Error(n.Errors.NO_ZIP);t.entries.forEach((function(t){var s=c(e,t.entryName.toString());if(t.isDirectory)n.makeDir(s);else{var i=t.getData();if(!i)throw new Error(n.Errors.CANT_EXTRACT_FILE);n.writeFileTo(s,i,r);try{o.utimesSync(s,t.header.time,t.header.time)}catch(e){throw new Error(n.Errors.CANT_EXTRACT_FILE)}}}))},extractAllToAsync:function(e,r,i){if(i||(i=function(){}),r=r||!1,t){var a=t.entries,l=a.length;a.forEach((function(t){if(!(l<=0)){var a=s.normalize(t.entryName.toString());if(t.isDirectory)return n.makeDir(c(e,a)),void(0==--l&&i(void 0));t.getDataAsync((function(f,h){if(!(l<=0)){if(!h)return f?void n.writeFileToAsync(c(e,a),f,r,(function(r){try{o.utimesSync(s.resolve(e,a),t.header.time,t.header.time)}catch(e){i(new Error("Unable to set utimes"))}if(!(l<=0))return r?void(0==--l&&i(void 0)):(l=0,void i(new Error("Unable to write")))})):(l=0,void i(new Error(n.Errors.CANT_EXTRACT_FILE)));i(new Error(h))}}))}}))}else i(new Error(n.Errors.NO_ZIP))},writeZip:function(e,o){if(1===arguments.length&&"function"==typeof e&&(o=e,e=""),!e&&r&&(e=r),e){var s=t.compressToBuffer();if(s){var i=n.writeFileTo(e,s,!0);"function"==typeof o&&o(i?null:new Error("failed"),"")}}},toBuffer:function(e,r,n,o){return this.valueOf=2,"function"==typeof e?(t.toAsyncBuffer(e,r,n,o),null):t.compressToBuffer()}}}},2907:(e,t,r)=>{var n=r(5173),o=n.Constants;e.exports=function(){var e=10,t=10,r=0,s=0,i=0,a=0,c=0,l=0,f=0,h=0,u=0,d=0,p=0,m=0,g=0,y={};function _(e){e=new Date(e),i=(e.getFullYear()-1980&127)<<25|e.getMonth()+1<<21|e.getDate()<<16|e.getHours()<<11|e.getMinutes()<<5|e.getSeconds()>>1}return _(+new Date),{get made(){return e},set made(t){e=t},get version(){return t},set version(e){t=e},get flags(){return r},set flags(e){r=e},get method(){return s},set method(e){s=e},get time(){return new Date(1980+(i>>25&127),(i>>21&15)-1,i>>16&31,i>>11&31,i>>5&63,(31&i)<<1)},set time(e){_(e)},get crc(){return a},set crc(e){a=e},get compressedSize(){return c},set compressedSize(e){c=e},get size(){return l},set size(e){l=e},get fileNameLength(){return f},set fileNameLength(e){f=e},get extraLength(){return h},set extraLength(e){h=e},get commentLength(){return u},set commentLength(e){u=e},get diskNumStart(){return d},set diskNumStart(e){d=e},get inAttr(){return p},set inAttr(e){p=e},get attr(){return m},set attr(e){m=e},get offset(){return g},set offset(e){g=e},get encripted(){return 1==(1&r)},get entryHeaderSize(){return o.CENHDR+f+h+u},get realDataOffset(){return g+o.LOCHDR+y.fnameLen+y.extraLen},get dataHeader(){return y},loadDataHeaderFromBinary:function(e){var t=e.slice(g,g+o.LOCHDR);if(t.readUInt32LE(0)!==o.LOCSIG)throw new Error(n.Errors.INVALID_LOC);y={version:t.readUInt16LE(o.LOCVER),flags:t.readUInt16LE(o.LOCFLG),method:t.readUInt16LE(o.LOCHOW),time:t.readUInt32LE(o.LOCTIM),crc:t.readUInt32LE(o.LOCCRC),compressedSize:t.readUInt32LE(o.LOCSIZ),size:t.readUInt32LE(o.LOCLEN),fnameLen:t.readUInt16LE(o.LOCNAM),extraLen:t.readUInt16LE(o.LOCEXT)}},loadFromBinary:function(y){if(y.length!==o.CENHDR||y.readUInt32LE(0)!==o.CENSIG)throw new Error(n.Errors.INVALID_CEN);e=y.readUInt16LE(o.CENVEM),t=y.readUInt16LE(o.CENVER),r=y.readUInt16LE(o.CENFLG),s=y.readUInt16LE(o.CENHOW),i=y.readUInt32LE(o.CENTIM),a=y.readUInt32LE(o.CENCRC),c=y.readUInt32LE(o.CENSIZ),l=y.readUInt32LE(o.CENLEN),f=y.readUInt16LE(o.CENNAM),h=y.readUInt16LE(o.CENEXT),u=y.readUInt16LE(o.CENCOM),d=y.readUInt16LE(o.CENDSK),p=y.readUInt16LE(o.CENATT),m=y.readUInt32LE(o.CENATX),g=y.readUInt32LE(o.CENOFF)},dataHeaderToBinary:function(){var e=Buffer.alloc(o.LOCHDR);return e.writeUInt32LE(o.LOCSIG,0),e.writeUInt16LE(t,o.LOCVER),e.writeUInt16LE(r,o.LOCFLG),e.writeUInt16LE(s,o.LOCHOW),e.writeUInt32LE(i,o.LOCTIM),e.writeUInt32LE(a,o.LOCCRC),e.writeUInt32LE(c,o.LOCSIZ),e.writeUInt32LE(l,o.LOCLEN),e.writeUInt16LE(f,o.LOCNAM),e.writeUInt16LE(h,o.LOCEXT),e},entryHeaderToBinary:function(){var n=Buffer.alloc(o.CENHDR+f+h+u);return n.writeUInt32LE(o.CENSIG,0),n.writeUInt16LE(e,o.CENVEM),n.writeUInt16LE(t,o.CENVER),n.writeUInt16LE(r,o.CENFLG),n.writeUInt16LE(s,o.CENHOW),n.writeUInt32LE(i,o.CENTIM),n.writeUInt32LE(a,o.CENCRC),n.writeUInt32LE(c,o.CENSIZ),n.writeUInt32LE(l,o.CENLEN),n.writeUInt16LE(f,o.CENNAM),n.writeUInt16LE(h,o.CENEXT),n.writeUInt16LE(u,o.CENCOM),n.writeUInt16LE(d,o.CENDSK),n.writeUInt16LE(p,o.CENATT),n.writeUInt32LE(m,o.CENATX),n.writeUInt32LE(g,o.CENOFF),n.fill(0,o.CENHDR),n},toString:function(){return'{\n\t"made" : '+e+',\n\t"version" : '+t+',\n\t"flags" : '+r+',\n\t"method" : '+n.methodToString(s)+',\n\t"time" : '+this.time+',\n\t"crc" : 0x'+a.toString(16).toUpperCase()+',\n\t"compressedSize" : '+c+' bytes,\n\t"size" : '+l+' bytes,\n\t"fileNameLength" : '+f+',\n\t"extraLength" : '+h+' bytes,\n\t"commentLength" : '+u+' bytes,\n\t"diskNumStart" : '+d+',\n\t"inAttr" : '+p+',\n\t"attr" : '+m+',\n\t"offset" : '+g+',\n\t"entryHeaderSize" : '+(o.CENHDR+f+h+u)+" bytes\n}"}}}},3854:(e,t,r)=>{t.EntryHeader=r(2907),t.MainHeader=r(3519)},3519:(e,t,r)=>{var n=r(5173),o=n.Constants;e.exports=function(){var e=0,t=0,r=0,s=0,i=0;return{get diskEntries(){return e},set diskEntries(r){e=t=r},get totalEntries(){return t},set totalEntries(r){t=e=r},get size(){return r},set size(e){r=e},get offset(){return s},set offset(e){s=e},get commentLength(){return i},set commentLength(e){i=e},get mainHeaderSize(){return o.ENDHDR+i},loadFromBinary:function(a){if((a.length!==o.ENDHDR||a.readUInt32LE(0)!==o.ENDSIG)&&(a.length<o.ZIP64HDR||a.readUInt32LE(0)!==o.ZIP64SIG))throw new Error(n.Errors.INVALID_END);a.readUInt32LE(0)===o.ENDSIG?(e=a.readUInt16LE(o.ENDSUB),t=a.readUInt16LE(o.ENDTOT),r=a.readUInt32LE(o.ENDSIZ),s=a.readUInt32LE(o.ENDOFF),i=a.readUInt16LE(o.ENDCOM)):(e=n.readBigUInt64LE(a,o.ZIP64SUB),t=n.readBigUInt64LE(a,o.ZIP64TOT),r=n.readBigUInt64LE(a,o.ZIP64SIZ),s=n.readBigUInt64LE(a,o.ZIP64OFF),i=0)},toBinary:function(){var n=Buffer.alloc(o.ENDHDR+i);return n.writeUInt32LE(o.ENDSIG,0),n.writeUInt32LE(0,4),n.writeUInt16LE(e,o.ENDSUB),n.writeUInt16LE(t,o.ENDTOT),n.writeUInt32LE(r,o.ENDSIZ),n.writeUInt32LE(s,o.ENDOFF),n.writeUInt16LE(i,o.ENDCOM),n.fill(" ",o.ENDHDR),n},toString:function(){return'{\n\t"diskEntries" : '+e+',\n\t"totalEntries" : '+t+',\n\t"size" : '+r+' bytes,\n\t"offset" : 0x'+s.toString(16).toUpperCase()+',\n\t"commentLength" : 0x'+i+"\n}"}}}},753:(e,t,r)=>{e.exports=function(e){var t=r(8761),n={chunkSize:1024*(parseInt(e.length/1024)+1)};return{deflate:function(){return t.deflateRawSync(e,n)},deflateAsync:function(r){var o=t.createDeflateRaw(n),s=[],i=0;o.on("data",(function(e){s.push(e),i+=e.length})),o.on("end",(function(){var e=Buffer.alloc(i),t=0;e.fill(0);for(var n=0;n<s.length;n++){var o=s[n];o.copy(e,t),t+=o.length}r&&r(e)})),o.end(e)}}}},1004:(e,t,r)=>{t.Deflater=r(753),t.Inflater=r(1269)},1269:(e,t,r)=>{e.exports=function(e){var t=r(8761);return{inflate:function(){return t.inflateRawSync(e)},inflateAsync:function(r){var n=t.createInflateRaw(),o=[],s=0;n.on("data",(function(e){o.push(e),s+=e.length})),n.on("end",(function(){var e=Buffer.alloc(s),t=0;e.fill(0);for(var n=0;n<o.length;n++){var i=o[n];i.copy(e,t),t+=i.length}r&&r(e)})),n.end(e)}}}},5991:e=>{e.exports={LOCHDR:30,LOCSIG:67324752,LOCVER:4,LOCFLG:6,LOCHOW:8,LOCTIM:10,LOCCRC:14,LOCSIZ:18,LOCLEN:22,LOCNAM:26,LOCEXT:28,EXTSIG:134695760,EXTHDR:16,EXTCRC:4,EXTSIZ:8,EXTLEN:12,CENHDR:46,CENSIG:33639248,CENVEM:4,CENVER:6,CENFLG:8,CENHOW:10,CENTIM:12,CENCRC:16,CENSIZ:20,CENLEN:24,CENNAM:28,CENEXT:30,CENCOM:32,CENDSK:34,CENATT:36,CENATX:38,CENOFF:42,ENDHDR:22,ENDSIG:101010256,ENDSUB:8,ENDTOT:10,ENDSIZ:12,ENDOFF:16,ENDCOM:20,END64HDR:20,END64SIG:117853008,END64START:4,END64OFF:8,END64NUMDISKS:16,ZIP64SIG:101075792,ZIP64HDR:56,ZIP64LEAD:12,ZIP64SIZE:4,ZIP64VEM:12,ZIP64VER:14,ZIP64DSK:16,ZIP64DSKDIR:20,ZIP64SUB:24,ZIP64TOT:32,ZIP64SIZB:40,ZIP64OFF:48,ZIP64EXTRA:56,STORED:0,SHRUNK:1,REDUCED1:2,REDUCED2:3,REDUCED3:4,REDUCED4:5,IMPLODED:6,DEFLATED:8,ENHANCED_DEFLATED:9,PKWARE:10,BZIP2:12,LZMA:14,IBM_TERSE:18,IBM_LZ77:19,FLG_ENC:0,FLG_COMP1:1,FLG_COMP2:2,FLG_DESC:4,FLG_ENH:8,FLG_STR:16,FLG_LNG:1024,FLG_MSK:4096,FILE:0,BUFFER:1,NONE:2,EF_ID:0,EF_SIZE:2,ID_ZIP64:1,ID_AVINFO:7,ID_PFS:8,ID_OS2:9,ID_NTFS:10,ID_OPENVMS:12,ID_UNIX:13,ID_FORK:14,ID_PATCH:15,ID_X509_PKCS7:20,ID_X509_CERTID_F:21,ID_X509_CERTID_C:22,ID_STRONGENC:23,ID_RECORD_MGT:24,ID_X509_PKCS7_RL:25,ID_IBM1:101,ID_IBM2:102,ID_POSZIP:18064,EF_ZIP64_OR_32:4294967295,EF_ZIP64_OR_16:65535,EF_ZIP64_SUNCOMP:0,EF_ZIP64_SCOMP:8,EF_ZIP64_RHO:16,EF_ZIP64_DSN:24}},2190:e=>{e.exports={INVALID_LOC:"Invalid LOC header (bad signature)",INVALID_CEN:"Invalid CEN header (bad signature)",INVALID_END:"Invalid END header (bad signature)",NO_DATA:"Nothing to decompress",BAD_CRC:"CRC32 checksum failed",FILE_IN_THE_WAY:"There is a file in the way: %s",UNKNOWN_METHOD:"Invalid/unsupported compression method",AVAIL_DATA:"inflate::Available inflate data did not terminate",INVALID_DISTANCE:"inflate::Invalid literal/length or distance code in fixed or dynamic block",TO_MANY_CODES:"inflate::Dynamic block code description: too many length or distance codes",INVALID_REPEAT_LEN:"inflate::Dynamic block code description: repeat more than specified lengths",INVALID_REPEAT_FIRST:"inflate::Dynamic block code description: repeat lengths with no first length",INCOMPLETE_CODES:"inflate::Dynamic block code description: code lengths codes incomplete",INVALID_DYN_DISTANCE:"inflate::Dynamic block code description: invalid distance code lengths",INVALID_CODES_LEN:"inflate::Dynamic block code description: invalid literal/length code lengths",INVALID_STORE_BLOCK:"inflate::Stored block length did not match one's complement",INVALID_BLOCK_TYPE:"inflate::Invalid block type (type == 3)",CANT_EXTRACT_FILE:"Could not extract the file",CANT_OVERRIDE:"Target file already exists",NO_ZIP:"No zip file was loaded",NO_ENTRY:"Entry doesn't exist",DIRECTORY_CONTENT_ERROR:"A directory cannot have content",FILE_NOT_FOUND:"File not found: %s",NOT_IMPLEMENTED:"Not implemented",INVALID_FILENAME:"Invalid filename",INVALID_FORMAT:"Invalid or unsupported zip format. No END header found"}},3455:(e,t,r)=>{var n=r(5147).require(),o=r(5622);n.existsSync=n.existsSync||o.existsSync,e.exports=function(e){var t=e||"",r={directory:!1,readonly:!1,hidden:!1,executable:!1,mtime:0,atime:0},s=null;return t&&n.existsSync(t)?(s=n.statSync(t),r.directory=s.isDirectory(),r.mtime=s.mtime,r.atime=s.atime,r.executable=!!(1&parseInt((s.mode&parseInt("777",8)).toString(8)[0])),r.readonly=!!(2&parseInt((s.mode&parseInt("777",8)).toString(8)[0])),r.hidden="."===o.basename(t)[0]):console.warn("Invalid path: "+t),{get directory(){return r.directory},get readOnly(){return r.readonly},get hidden(){return r.hidden},get mtime(){return r.mtime},get atime(){return r.atime},get executable(){return r.executable},decodeAttributes:function(e){},encodeAttributes:function(e){},toString:function(){return'{\n\t"path" : "'+t+',\n\t"isDirectory" : '+r.directory+',\n\t"isReadOnly" : '+r.readonly+',\n\t"isHidden" : '+r.hidden+',\n\t"isExecutable" : '+r.executable+',\n\t"mTime" : '+r.mtime+'\n\t"aTime" : '+r.atime+"\n}"}}}},5147:(e,t,r)=>{t.require=function(){var e=r(5747);if(process.versions.electron)try{originalFs=r(Object(function(){var e=new Error("Cannot find module 'original-fs'");throw e.code="MODULE_NOT_FOUND",e}())),Object.keys(originalFs).length>0&&(e=originalFs)}catch(e){}return e}},5173:(e,t,r)=>{e.exports=r(7646),e.exports.FileSystem=r(5147),e.exports.Constants=r(5991),e.exports.Errors=r(2190),e.exports.FileAttr=r(3455)},7646:(e,t,r)=>{var n=r(5147).require(),o=r(5622);n.existsSync=n.existsSync||o.existsSync,e.exports=function(){var e=[],t=r(5991),s=r(2190),i=o.sep;function a(e){var t=e.split(i)[0];e.split(i).forEach((function(e){if(e&&":"!==e.substr(-1,1)){var r;t+=i+e;try{r=n.statSync(t)}catch(e){n.mkdirSync(t)}if(r&&r.isFile())throw s.FILE_IN_THE_WAY.replace("%s",t)}}))}function c(e,t,r){"boolean"==typeof t&&(r=t,t=void 0);var s=[];return n.readdirSync(e).forEach((function(a){var l=o.join(e,a);n.statSync(l).isDirectory()&&r&&(s=s.concat(c(l,t,r))),t&&!t.test(l)||s.push(o.normalize(l)+(n.statSync(l).isDirectory()?i:""))})),s}return{makeDir:function(e){a(e)},crc32:function(t){"string"==typeof t&&(t=Buffer.alloc(t.length,t));var r=Buffer.alloc(4);if(!e.length)for(var n=0;n<256;n++){for(var o=n,s=8;--s>=0;)0!=(1&o)?o=3988292384^o>>>1:o>>>=1;o<0&&(r.writeInt32LE(o,0),o=r.readUInt32LE(0)),e[n]=o}for(var i=0,a=0,c=t.length,l=~i;--c>=0;)l=e[255&(l^t[a++])]^l>>>8;return i=~l,r.writeInt32LE(4294967295&i,0),r.readUInt32LE(0)},methodToString:function(e){switch(e){case t.STORED:return"STORED ("+e+")";case t.DEFLATED:return"DEFLATED ("+e+")";default:return"UNSUPPORTED ("+e+")"}},writeFileTo:function(e,t,r,s){if(n.existsSync(e)){if(!r)return!1;if(n.statSync(e).isDirectory())return!1}var i,c=o.dirname(e);n.existsSync(c)||a(c);try{i=n.openSync(e,"w",438)}catch(t){n.chmodSync(e,438),i=n.openSync(e,"w",438)}if(i)try{n.writeSync(i,t,0,t.length,0)}catch(e){throw e}finally{n.closeSync(i)}return n.chmodSync(e,s||438),!0},writeFileToAsync:function(e,t,r,s,i){"function"==typeof s&&(i=s,s=void 0),n.exists(e,(function(c){if(c&&!r)return i(!1);n.stat(e,(function(r,l){if(c&&l.isDirectory())return i(!1);var f=o.dirname(e);n.exists(f,(function(r){r||a(f),n.open(e,"w",438,(function(r,o){r?n.chmod(e,438,(function(){n.open(e,"w",438,(function(r,o){n.write(o,t,0,t.length,0,(function(){n.close(o,(function(){n.chmod(e,s||438,(function(){i(!0)}))}))}))}))})):o?n.write(o,t,0,t.length,0,(function(){n.close(o,(function(){n.chmod(e,s||438,(function(){i(!0)}))}))})):n.chmod(e,s||438,(function(){i(!0)}))}))}))}))}))},findFiles:function(e){return c(e,!0)},getAttributes:function(e){},setAttributes:function(e){},toBuffer:function(e){return Buffer.isBuffer(e)?e:0===e.length?Buffer.alloc(0):Buffer.from(e,"utf8")},readBigUInt64LE:function(e,t){var r=Buffer.from(e.slice(t,t+8));return r.swap64(),parseInt("0x"+r.toString("hex"))},Constants:t,Errors:s}}()},7396:(e,t,r)=>{var n=r(5173),o=r(3854),s=n.Constants,i=r(1004);e.exports=function(e){var t=new o.EntryHeader,r=Buffer.alloc(0),a=Buffer.alloc(0),c=!1,l=null,f=Buffer.alloc(0);function h(){return e&&Buffer.isBuffer(e)?(t.loadDataHeaderFromBinary(e),e.slice(t.realDataOffset,t.realDataOffset+t.compressedSize)):Buffer.alloc(0)}function u(e){return 8==(8&t.flags)||n.crc32(e)===t.dataHeader.crc}function d(e,o,s){if(void 0===o&&"string"==typeof e&&(e=void 0),c)return e&&o&&o(Buffer.alloc(0),n.Errors.DIRECTORY_CONTENT_ERROR),Buffer.alloc(0);var a=h();if(0===a.length)return e&&o&&o(a),a;var l=Buffer.alloc(t.size);switch(t.method){case n.Constants.STORED:if(a.copy(l),u(l))return e&&o&&o(l),l;throw e&&o&&o(l,n.Errors.BAD_CRC),new Error(n.Errors.BAD_CRC);case n.Constants.DEFLATED:var f=new i.Inflater(a);if(!e){if(f.inflate(l).copy(l,0),!u(l))throw new Error(n.Errors.BAD_CRC+" "+r.toString());return l}f.inflateAsync((function(e){e.copy(l,0),u(l)?o&&o(l):o&&o(l,n.Errors.BAD_CRC)}));break;default:throw e&&o&&o(Buffer.alloc(0),n.Errors.UNKNOWN_METHOD),new Error(n.Errors.UNKNOWN_METHOD)}}function p(r,o){if((!l||!l.length)&&Buffer.isBuffer(e))return r&&o&&o(h()),h();if(l.length&&!c){var s;switch(t.method){case n.Constants.STORED:return t.compressedSize=t.size,s=Buffer.alloc(l.length),l.copy(s),r&&o&&o(s),s;default:case n.Constants.DEFLATED:var a=new i.Deflater(l);if(!r){var f=a.deflate();return t.compressedSize=f.length,f}a.deflateAsync((function(e){s=Buffer.alloc(e.length),t.compressedSize=e.length,e.copy(s),o&&o(s)})),a=null}}else{if(!r||!o)return Buffer.alloc(0);o(Buffer.alloc(0))}}function m(e,t){return(e.readUInt32LE(t+4)<<4)+e.readUInt32LE(t)}function g(e){var r,n,o,i;e.length>=s.EF_ZIP64_SCOMP&&(r=m(e,s.EF_ZIP64_SUNCOMP),t.size===s.EF_ZIP64_OR_32&&(t.size=r)),e.length>=s.EF_ZIP64_RHO&&(n=m(e,s.EF_ZIP64_SCOMP),t.compressedSize===s.EF_ZIP64_OR_32&&(t.compressedSize=n)),e.length>=s.EF_ZIP64_DSN&&(o=m(e,s.EF_ZIP64_RHO),t.offset===s.EF_ZIP64_OR_32&&(t.offset=o)),e.length>=s.EF_ZIP64_DSN+4&&(i=e.readUInt32LE(s.EF_ZIP64_DSN),t.diskNumStart===s.EF_ZIP64_OR_16&&(t.diskNumStart=i))}return{get entryName(){return r.toString()},get rawEntryName(){return r},set entryName(e){var o=(r=n.toBuffer(e))[r.length-1];c=47===o||92===o,t.fileNameLength=r.length},get extra(){return f},set extra(e){f=e,t.extraLength=e.length,function(e){for(var t,r,n,o=0;o<e.length;)t=e.readUInt16LE(o),o+=2,r=e.readUInt16LE(o),o+=2,n=e.slice(o,o+r),o+=r,s.ID_ZIP64===t&&g(n)}(e)},get comment(){return a.toString()},set comment(e){a=n.toBuffer(e),t.commentLength=a.length},get name(){var e=r.toString();return c?e.substr(e.length-1).split("/").pop():e.split("/").pop()},get isDirectory(){return c},getCompressedData:function(){return p(!1,null)},getCompressedDataAsync:function(e){p(!0,e)},setData:function(e){l=n.toBuffer(e),!c&&l.length?(t.size=l.length,t.method=n.Constants.DEFLATED,t.crc=n.crc32(e),t.changed=!0):t.method=n.Constants.STORED},getData:function(e){return t.changed?l:d(!1,null)},getDataAsync:function(e,r){t.changed?e(l):d(!0,e)},set attr(e){t.attr=e},get attr(){return t.attr},set header(e){t.loadFromBinary(e)},get header(){return t},packHeader:function(){var e=t.entryHeaderToBinary();return r.copy(e,n.Constants.CENHDR),t.extraLength&&f.copy(e,n.Constants.CENHDR+r.length),t.commentLength&&a.copy(e,n.Constants.CENHDR+r.length+t.extraLength,a.length),e},toString:function(){return'{\n\t"entryName" : "'+r.toString()+'",\n\t"name" : "'+(c?r.toString().replace(/\/$/,"").split("/").pop():r.toString().split("/").pop())+'",\n\t"comment" : "'+a.toString()+'",\n\t"isDirectory" : '+c+',\n\t"header" : '+t.toString().replace(/\t/gm,"\t\t").replace(/}/gm,"\t}")+',\n\t"compressedData" : <'+(e&&e.length+" bytes buffer"||"null")+'>\n\t"data" : <'+(l&&l.length+" bytes buffer"||"null")+">\n}"}}}},6333:(e,t,r)=>{var n=r(7396),o=r(3854),s=r(5173);e.exports=function(e,t){var r=[],i={},a=Buffer.alloc(0),c="",l=s.FileSystem.require(),f=null,h=new o.MainHeader,u=!1;function d(){u=!0,i={},r=new Array(h.diskEntries);for(var e=h.offset,t=0;t<r.length;t++){var o=e,a=new n(f);a.header=f.slice(o,o+=s.Constants.CENHDR),a.entryName=f.slice(o,o+=a.header.fileNameLength),a.header.extraLength&&(a.extra=f.slice(o,o+=a.header.extraLength)),a.header.commentLength&&(a.comment=f.slice(o,o+a.header.commentLength)),e+=a.header.entryHeaderSize,r[t]=a,i[a.entryName]=a}}function p(){for(var e=f.length-s.Constants.ENDHDR,t=Math.max(0,e-65535),r=t,n=f.length,o=-1,i=0;e>=r;e--)if(80===f[e])if(f.readUInt32LE(e)!==s.Constants.ENDSIG)if(f.readUInt32LE(e)!==s.Constants.END64SIG){if(f.readUInt32LE(e)==s.Constants.ZIP64SIG){o=e,n=e+s.readBigUInt64LE(f,e+s.Constants.ZIP64SIZE)+s.Constants.ZIP64LEAD;break}}else r=t;else o=e,i=e,n=e+s.Constants.ENDHDR,r=e-s.Constants.END64HDR;if(!~o)throw new Error(s.Errors.INVALID_FORMAT);h.loadFromBinary(f.slice(o,n)),h.commentLength&&(a=f.slice(i+s.Constants.ENDHDR))}return t===s.Constants.FILE?(c=e,f=l.readFileSync(c),p()):t===s.Constants.BUFFER?(f=e,p()):u=!0,{get entries(){return u||d(),r},get comment(){return a.toString()},set comment(e){h.commentLength=e.length,a=e},getEntryCount:function(){return u?r.length:h.diskEntries},forEach:function(e){u?r.forEach(e):function(e){const t=h.diskEntries;let r=h.offset;for(let o=0;o<t;o++){let t=r;const o=new n(f);o.header=f.slice(t,t+=s.Constants.CENHDR),o.entryName=f.slice(t,t+=o.header.fileNameLength),r+=o.header.entryHeaderSize,e(o)}}(e)},getEntry:function(e){return u||d(),i[e]||null},setEntry:function(e){u||d(),r.push(e),i[e.entryName]=e,h.totalEntries=r.length},deleteEntry:function(e){u||d();var t=i[e];if(t&&t.isDirectory){var n=this;this.getEntryChildren(t).forEach((function(t){t.entryName!==e&&n.deleteEntry(t.entryName)}))}r.splice(r.indexOf(t),1),delete i[e],h.totalEntries=r.length},getEntryChildren:function(e){if(u||d(),e.isDirectory){var t=[],n=e.entryName,o=n.length;return r.forEach((function(e){e.entryName.substr(0,o)===n&&t.push(e)})),t}return[]},compressToBuffer:function(){u||d(),r.length>1&&r.sort((function(e,t){var r=e.entryName.toLowerCase(),n=t.entryName.toLowerCase();return r<n?-1:r>n?1:0}));var e=0,t=[],n=[],o=0;h.size=0,h.offset=0,r.forEach((function(r){var s=r.getCompressedData();r.header.offset=o;var i=r.header.dataHeaderToBinary(),a=r.rawEntryName.length,c=r.extra.toString(),l=Buffer.alloc(a+c.length);r.rawEntryName.copy(l,0),l.fill(c,a);var f=i.length+l.length+s.length;o+=f,t.push(i),t.push(l),t.push(s);var u=r.packHeader();n.push(u),h.size+=u.length,e+=f+u.length})),e+=h.mainHeaderSize,h.offset=o,o=0;var i=Buffer.alloc(e);t.forEach((function(e){e.copy(i,o),o+=e.length})),n.forEach((function(e){e.copy(i,o),o+=e.length}));var c=h.toBinary();return a&&Buffer.from(a).copy(c,s.Constants.ENDHDR),c.copy(i,o),i},toAsyncBuffer:function(e,t,n,o){u||d(),r.length>1&&r.sort((function(e,t){var r=e.entryName.toLowerCase(),n=t.entryName.toLowerCase();return r>n?-1:r<n?1:0}));var i=0,c=[],l=[],f=0;h.size=0,h.offset=0,function(t){var r=arguments.callee;if(t.length){var u=t.pop(),d=u.entryName+u.extra.toString();n&&n(d),u.getCompressedDataAsync((function(n){o&&o(d),u.header.offset=f;var p,m=u.header.dataHeaderToBinary();try{p=Buffer.alloc(d.length,d)}catch(e){p=new Buffer(d)}var g=m.length+p.length+n.length;f+=g,c.push(m),c.push(p),c.push(n);var y=u.packHeader();if(l.push(y),h.size+=y.length,i+=g+y.length,t.length)r(t);else{i+=h.mainHeaderSize,h.offset=f,f=0;var _=Buffer.alloc(i);c.forEach((function(e){e.copy(_,f),f+=e.length})),l.forEach((function(e){e.copy(_,f),f+=e.length}));var E=h.toBinary();a&&a.copy(E,s.Constants.ENDHDR),E.copy(_,f),e(_)}}))}}(r)}}}},8777:(e,t,r)=>{"use strict";const n=r(8762);n.createWebSocketStream=r(404),n.Server=r(9284),n.Receiver=r(2957),n.Sender=r(7330),e.exports=n},977:(e,t,r)=>{"use strict";const{EMPTY_BUFFER:n}=r(1872);function o(e,t){if(0===e.length)return n;if(1===e.length)return e[0];const r=Buffer.allocUnsafe(t);let o=0;for(let t=0;t<e.length;t++){const n=e[t];r.set(n,o),o+=n.length}return o<t?r.slice(0,o):r}function s(e,t,r,n,o){for(let s=0;s<o;s++)r[n+s]=e[s]^t[3&s]}function i(e,t){const r=e.length;for(let n=0;n<r;n++)e[n]^=t[3&n]}function a(e){return e.byteLength===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}function c(e){if(c.readOnly=!0,Buffer.isBuffer(e))return e;let t;return e instanceof ArrayBuffer?t=Buffer.from(e):ArrayBuffer.isView(e)?t=Buffer.from(e.buffer,e.byteOffset,e.byteLength):(t=Buffer.from(e),c.readOnly=!1),t}try{const t=r(Object(function(){var e=new Error("Cannot find module 'bufferutil'");throw e.code="MODULE_NOT_FOUND",e}())),n=t.BufferUtil||t;e.exports={concat:o,mask(e,t,r,o,i){i<48?s(e,t,r,o,i):n.mask(e,t,r,o,i)},toArrayBuffer:a,toBuffer:c,unmask(e,t){e.length<32?i(e,t):n.unmask(e,t)}}}catch(t){e.exports={concat:o,mask:s,toArrayBuffer:a,toBuffer:c,unmask:i}}},1872:e=>{"use strict";e.exports={BINARY_TYPES:["nodebuffer","arraybuffer","fragments"],GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),EMPTY_BUFFER:Buffer.alloc(0),NOOP:()=>{}}},62:e=>{"use strict";class t{constructor(e,t){this.target=t,this.type=e}}class r extends t{constructor(e,t){super("message",t),this.data=e}}class n extends t{constructor(e,t,r){super("close",r),this.wasClean=r._closeFrameReceived&&r._closeFrameSent,this.reason=t,this.code=e}}class o extends t{constructor(e){super("open",e)}}class s extends t{constructor(e,t){super("error",t),this.message=e.message,this.error=e}}const i={addEventListener(e,t,i){if("function"!=typeof t)return;function a(e){t.call(this,new r(e,this))}function c(e,r){t.call(this,new n(e,r,this))}function l(e){t.call(this,new s(e,this))}function f(){t.call(this,new o(this))}const h=i&&i.once?"once":"on";"message"===e?(a._listener=t,this[h](e,a)):"close"===e?(c._listener=t,this[h](e,c)):"error"===e?(l._listener=t,this[h](e,l)):"open"===e?(f._listener=t,this[h](e,f)):this[h](e,t)},removeEventListener(e,t){const r=this.listeners(e);for(let n=0;n<r.length;n++)r[n]!==t&&r[n]._listener!==t||this.removeListener(e,r[n])}};e.exports=i},1503:e=>{"use strict";const t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0];function r(e,t,r){void 0===e[t]?e[t]=[r]:e[t].push(r)}e.exports={format:function(e){return Object.keys(e).map((t=>{let r=e[t];return Array.isArray(r)||(r=[r]),r.map((e=>[t].concat(Object.keys(e).map((t=>{let r=e[t];return Array.isArray(r)||(r=[r]),r.map((e=>!0===e?t:`${t}=${e}`)).join("; ")}))).join("; "))).join(", ")})).join(", ")},parse:function(e){const n=Object.create(null);if(void 0===e||""===e)return n;let o,s,i=Object.create(null),a=!1,c=!1,l=!1,f=-1,h=-1,u=0;for(;u<e.length;u++){const d=e.charCodeAt(u);if(void 0===o)if(-1===h&&1===t[d])-1===f&&(f=u);else if(32===d||9===d)-1===h&&-1!==f&&(h=u);else{if(59!==d&&44!==d)throw new SyntaxError("Unexpected character at index "+u);{if(-1===f)throw new SyntaxError("Unexpected character at index "+u);-1===h&&(h=u);const t=e.slice(f,h);44===d?(r(n,t,i),i=Object.create(null)):o=t,f=h=-1}}else if(void 0===s)if(-1===h&&1===t[d])-1===f&&(f=u);else if(32===d||9===d)-1===h&&-1!==f&&(h=u);else if(59===d||44===d){if(-1===f)throw new SyntaxError("Unexpected character at index "+u);-1===h&&(h=u),r(i,e.slice(f,h),!0),44===d&&(r(n,o,i),i=Object.create(null),o=void 0),f=h=-1}else{if(61!==d||-1===f||-1!==h)throw new SyntaxError("Unexpected character at index "+u);s=e.slice(f,u),f=h=-1}else if(c){if(1!==t[d])throw new SyntaxError("Unexpected character at index "+u);-1===f?f=u:a||(a=!0),c=!1}else if(l)if(1===t[d])-1===f&&(f=u);else if(34===d&&-1!==f)l=!1,h=u;else{if(92!==d)throw new SyntaxError("Unexpected character at index "+u);c=!0}else if(34===d&&61===e.charCodeAt(u-1))l=!0;else if(-1===h&&1===t[d])-1===f&&(f=u);else if(-1===f||32!==d&&9!==d){if(59!==d&&44!==d)throw new SyntaxError("Unexpected character at index "+u);{if(-1===f)throw new SyntaxError("Unexpected character at index "+u);-1===h&&(h=u);let t=e.slice(f,h);a&&(t=t.replace(/\\/g,""),a=!1),r(i,s,t),44===d&&(r(n,o,i),i=Object.create(null),o=void 0),s=void 0,f=h=-1}}else-1===h&&(h=u)}if(-1===f||l)throw new SyntaxError("Unexpected end of input");-1===h&&(h=u);const d=e.slice(f,h);return void 0===o?r(n,d,i):(void 0===s?r(i,d,!0):r(i,s,a?d.replace(/\\/g,""):d),r(n,o,i)),n}}},305:e=>{"use strict";const t=Symbol("kDone"),r=Symbol("kRun");e.exports=class{constructor(e){this[t]=()=>{this.pending--,this[r]()},this.concurrency=e||1/0,this.jobs=[],this.pending=0}add(e){this.jobs.push(e),this[r]()}[r](){if(this.pending!==this.concurrency&&this.jobs.length){const e=this.jobs.shift();this.pending++,e(this[t])}}}},5196:(e,t,r)=>{"use strict";const n=r(8761),o=r(977),s=r(305),{kStatusCode:i,NOOP:a}=r(1872),c=Buffer.from([0,0,255,255]),l=Symbol("permessage-deflate"),f=Symbol("total-length"),h=Symbol("callback"),u=Symbol("buffers"),d=Symbol("error");let p;function m(e){this[u].push(e),this[f]+=e.length}function g(e){this[f]+=e.length,this[l]._maxPayload<1||this[f]<=this[l]._maxPayload?this[u].push(e):(this[d]=new RangeError("Max payload size exceeded"),this[d][i]=1009,this.removeListener("data",g),this.reset())}function y(e){this[l]._inflate=null,e[i]=1007,this[h](e)}e.exports=class{constructor(e,t,r){if(this._maxPayload=0|r,this._options=e||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!t,this._deflate=null,this._inflate=null,this.params=null,!p){const e=void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10;p=new s(e)}}static get extensionName(){return"permessage-deflate"}offer(){const e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){const e=this._deflate[h];this._deflate.close(),this._deflate=null,e&&e(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(e){const t=this._options,r=e.find((e=>!(!1===t.serverNoContextTakeover&&e.server_no_context_takeover||e.server_max_window_bits&&(!1===t.serverMaxWindowBits||"number"==typeof t.serverMaxWindowBits&&t.serverMaxWindowBits>e.server_max_window_bits)||"number"==typeof t.clientMaxWindowBits&&!e.client_max_window_bits)));if(!r)throw new Error("None of the extension offers can be accepted");return t.serverNoContextTakeover&&(r.server_no_context_takeover=!0),t.clientNoContextTakeover&&(r.client_no_context_takeover=!0),"number"==typeof t.serverMaxWindowBits&&(r.server_max_window_bits=t.serverMaxWindowBits),"number"==typeof t.clientMaxWindowBits?r.client_max_window_bits=t.clientMaxWindowBits:!0!==r.client_max_window_bits&&!1!==t.clientMaxWindowBits||delete r.client_max_window_bits,r}acceptAsClient(e){const t=e[0];if(!1===this._options.clientNoContextTakeover&&t.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(t.client_max_window_bits){if(!1===this._options.clientMaxWindowBits||"number"==typeof this._options.clientMaxWindowBits&&t.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"')}else"number"==typeof this._options.clientMaxWindowBits&&(t.client_max_window_bits=this._options.clientMaxWindowBits);return t}normalizeParams(e){return e.forEach((e=>{Object.keys(e).forEach((t=>{let r=e[t];if(r.length>1)throw new Error(`Parameter "${t}" must have only a single value`);if(r=r[0],"client_max_window_bits"===t){if(!0!==r){const e=+r;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${r}`);r=e}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${t}": ${r}`)}else if("server_max_window_bits"===t){const e=+r;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${r}`);r=e}else{if("client_no_context_takeover"!==t&&"server_no_context_takeover"!==t)throw new Error(`Unknown parameter "${t}"`);if(!0!==r)throw new TypeError(`Invalid value for parameter "${t}": ${r}`)}e[t]=r}))})),e}decompress(e,t,r){p.add((n=>{this._decompress(e,t,((e,t)=>{n(),r(e,t)}))}))}compress(e,t,r){p.add((n=>{this._compress(e,t,((e,t)=>{n(),r(e,t)}))}))}_decompress(e,t,r){const s=this._isServer?"client":"server";if(!this._inflate){const e=s+"_max_window_bits",t="number"!=typeof this.params[e]?n.Z_DEFAULT_WINDOWBITS:this.params[e];this._inflate=n.createInflateRaw({...this._options.zlibInflateOptions,windowBits:t}),this._inflate[l]=this,this._inflate[f]=0,this._inflate[u]=[],this._inflate.on("error",y),this._inflate.on("data",g)}this._inflate[h]=r,this._inflate.write(e),t&&this._inflate.write(c),this._inflate.flush((()=>{const e=this._inflate[d];if(e)return this._inflate.close(),this._inflate=null,void r(e);const n=o.concat(this._inflate[u],this._inflate[f]);t&&this.params[s+"_no_context_takeover"]?(this._inflate.close(),this._inflate=null):(this._inflate[f]=0,this._inflate[u]=[]),r(null,n)}))}_compress(e,t,r){const s=this._isServer?"server":"client";if(!this._deflate){const e=s+"_max_window_bits",t="number"!=typeof this.params[e]?n.Z_DEFAULT_WINDOWBITS:this.params[e];this._deflate=n.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:t}),this._deflate[f]=0,this._deflate[u]=[],this._deflate.on("error",a),this._deflate.on("data",m)}this._deflate[h]=r,this._deflate.write(e),this._deflate.flush(n.Z_SYNC_FLUSH,(()=>{if(!this._deflate)return;let e=o.concat(this._deflate[u],this._deflate[f]);t&&(e=e.slice(0,e.length-4)),this._deflate[h]=null,t&&this.params[s+"_no_context_takeover"]?(this._deflate.close(),this._deflate=null):(this._deflate[f]=0,this._deflate[u]=[]),r(null,e)}))}}},2957:(e,t,r)=>{"use strict";const{Writable:n}=r(2413),o=r(5196),{BINARY_TYPES:s,EMPTY_BUFFER:i,kStatusCode:a,kWebSocket:c}=r(1872),{concat:l,toArrayBuffer:f,unmask:h}=r(977),{isValidStatusCode:u,isValidUTF8:d}=r(6746);function p(e,t,r,n){const o=new e(r?"Invalid WebSocket frame: "+t:t);return Error.captureStackTrace(o,p),o[a]=n,o}e.exports=class extends n{constructor(e,t,r,n){super(),this._binaryType=e||s[0],this[c]=void 0,this._extensions=t||{},this._isServer=!!r,this._maxPayload=0|n,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._state=0,this._loop=!1}_write(e,t,r){if(8===this._opcode&&0==this._state)return r();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(r)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){const t=this._buffers[0];return this._buffers[0]=t.slice(e),t.slice(0,e)}const t=Buffer.allocUnsafe(e);do{const r=this._buffers[0],n=t.length-e;e>=r.length?t.set(this._buffers.shift(),n):(t.set(new Uint8Array(r.buffer,r.byteOffset,e),n),this._buffers[0]=r.slice(e)),e-=r.length}while(e>0);return t}startLoop(e){let t;this._loop=!0;do{switch(this._state){case 0:t=this.getInfo();break;case 1:t=this.getPayloadLength16();break;case 2:t=this.getPayloadLength64();break;case 3:this.getMask();break;case 4:t=this.getData(e);break;default:return void(this._loop=!1)}}while(this._loop);e(t)}getInfo(){if(this._bufferedBytes<2)return void(this._loop=!1);const e=this.consume(2);if(0!=(48&e[0]))return this._loop=!1,p(RangeError,"RSV2 and RSV3 must be clear",!0,1002);const t=64==(64&e[0]);if(t&&!this._extensions[o.extensionName])return this._loop=!1,p(RangeError,"RSV1 must be clear",!0,1002);if(this._fin=128==(128&e[0]),this._opcode=15&e[0],this._payloadLength=127&e[1],0===this._opcode){if(t)return this._loop=!1,p(RangeError,"RSV1 must be clear",!0,1002);if(!this._fragmented)return this._loop=!1,p(RangeError,"invalid opcode 0",!0,1002);this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented)return this._loop=!1,p(RangeError,"invalid opcode "+this._opcode,!0,1002);this._compressed=t}else{if(!(this._opcode>7&&this._opcode<11))return this._loop=!1,p(RangeError,"invalid opcode "+this._opcode,!0,1002);if(!this._fin)return this._loop=!1,p(RangeError,"FIN must be set",!0,1002);if(t)return this._loop=!1,p(RangeError,"RSV1 must be clear",!0,1002);if(this._payloadLength>125)return this._loop=!1,p(RangeError,"invalid payload length "+this._payloadLength,!0,1002)}if(this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=128==(128&e[1]),this._isServer){if(!this._masked)return this._loop=!1,p(RangeError,"MASK must be set",!0,1002)}else if(this._masked)return this._loop=!1,p(RangeError,"MASK must be clear",!0,1002);if(126===this._payloadLength)this._state=1;else{if(127!==this._payloadLength)return this.haveLength();this._state=2}}getPayloadLength16(){if(!(this._bufferedBytes<2))return this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength();this._loop=!1}getPayloadLength64(){if(this._bufferedBytes<8)return void(this._loop=!1);const e=this.consume(8),t=e.readUInt32BE(0);return t>Math.pow(2,21)-1?(this._loop=!1,p(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009)):(this._payloadLength=t*Math.pow(2,32)+e.readUInt32BE(4),this.haveLength())}haveLength(){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0))return this._loop=!1,p(RangeError,"Max payload size exceeded",!1,1009);this._masked?this._state=3:this._state=4}getMask(){this._bufferedBytes<4?this._loop=!1:(this._mask=this.consume(4),this._state=4)}getData(e){let t=i;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength)return void(this._loop=!1);t=this.consume(this._payloadLength),this._masked&&h(t,this._mask)}return this._opcode>7?this.controlMessage(t):this._compressed?(this._state=5,void this.decompress(t,e)):(t.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(t)),this.dataMessage())}decompress(e,t){this._extensions[o.extensionName].decompress(e,this._fin,((e,r)=>{if(e)return t(e);if(r.length){if(this._messageLength+=r.length,this._messageLength>this._maxPayload&&this._maxPayload>0)return t(p(RangeError,"Max payload size exceeded",!1,1009));this._fragments.push(r)}const n=this.dataMessage();if(n)return t(n);this.startLoop(t)}))}dataMessage(){if(this._fin){const e=this._messageLength,t=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){let r;r="nodebuffer"===this._binaryType?l(t,e):"arraybuffer"===this._binaryType?f(l(t,e)):t,this.emit("message",r)}else{const r=l(t,e);if(!d(r))return this._loop=!1,p(Error,"invalid UTF-8 sequence",!0,1007);this.emit("message",r.toString())}}this._state=0}controlMessage(e){if(8===this._opcode)if(this._loop=!1,0===e.length)this.emit("conclude",1005,""),this.end();else{if(1===e.length)return p(RangeError,"invalid payload length 1",!0,1002);{const t=e.readUInt16BE(0);if(!u(t))return p(RangeError,"invalid status code "+t,!0,1002);const r=e.slice(2);if(!d(r))return p(Error,"invalid UTF-8 sequence",!0,1007);this.emit("conclude",t,r.toString()),this.end()}}else 9===this._opcode?this.emit("ping",e):this.emit("pong",e);this._state=0}}},7330:(e,t,r)=>{"use strict";const{randomFillSync:n}=r(6417),o=r(5196),{EMPTY_BUFFER:s}=r(1872),{isValidStatusCode:i}=r(6746),{mask:a,toBuffer:c}=r(977),l=Buffer.alloc(4);class f{constructor(e,t){this._extensions=t||{},this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._deflating=!1,this._queue=[]}static frame(e,t){const r=t.mask&&t.readOnly;let o=t.mask?6:2,s=e.length;e.length>=65536?(o+=8,s=127):e.length>125&&(o+=2,s=126);const i=Buffer.allocUnsafe(r?e.length+o:o);return i[0]=t.fin?128|t.opcode:t.opcode,t.rsv1&&(i[0]|=64),i[1]=s,126===s?i.writeUInt16BE(e.length,2):127===s&&(i.writeUInt32BE(0,2),i.writeUInt32BE(e.length,6)),t.mask?(n(l,0,4),i[1]|=128,i[o-4]=l[0],i[o-3]=l[1],i[o-2]=l[2],i[o-1]=l[3],r?(a(e,l,i,o,e.length),[i]):(a(e,l,e,0,e.length),[i,e])):[i,e]}close(e,t,r,n){let o;if(void 0===e)o=s;else{if("number"!=typeof e||!i(e))throw new TypeError("First argument must be a valid error code number");if(void 0===t||""===t)o=Buffer.allocUnsafe(2),o.writeUInt16BE(e,0);else{const r=Buffer.byteLength(t);if(r>123)throw new RangeError("The message must not be greater than 123 bytes");o=Buffer.allocUnsafe(2+r),o.writeUInt16BE(e,0),o.write(t,2)}}this._deflating?this.enqueue([this.doClose,o,r,n]):this.doClose(o,r,n)}doClose(e,t,r){this.sendFrame(f.frame(e,{fin:!0,rsv1:!1,opcode:8,mask:t,readOnly:!1}),r)}ping(e,t,r){const n=c(e);if(n.length>125)throw new RangeError("The data size must not be greater than 125 bytes");this._deflating?this.enqueue([this.doPing,n,t,c.readOnly,r]):this.doPing(n,t,c.readOnly,r)}doPing(e,t,r,n){this.sendFrame(f.frame(e,{fin:!0,rsv1:!1,opcode:9,mask:t,readOnly:r}),n)}pong(e,t,r){const n=c(e);if(n.length>125)throw new RangeError("The data size must not be greater than 125 bytes");this._deflating?this.enqueue([this.doPong,n,t,c.readOnly,r]):this.doPong(n,t,c.readOnly,r)}doPong(e,t,r,n){this.sendFrame(f.frame(e,{fin:!0,rsv1:!1,opcode:10,mask:t,readOnly:r}),n)}send(e,t,r){const n=c(e),s=this._extensions[o.extensionName];let i=t.binary?2:1,a=t.compress;if(this._firstFragment?(this._firstFragment=!1,a&&s&&(a=n.length>=s._threshold),this._compress=a):(a=!1,i=0),t.fin&&(this._firstFragment=!0),s){const e={fin:t.fin,rsv1:a,opcode:i,mask:t.mask,readOnly:c.readOnly};this._deflating?this.enqueue([this.dispatch,n,this._compress,e,r]):this.dispatch(n,this._compress,e,r)}else this.sendFrame(f.frame(n,{fin:t.fin,rsv1:!1,opcode:i,mask:t.mask,readOnly:c.readOnly}),r)}dispatch(e,t,r,n){if(!t)return void this.sendFrame(f.frame(e,r),n);const s=this._extensions[o.extensionName];this._bufferedBytes+=e.length,this._deflating=!0,s.compress(e,r.fin,((t,o)=>{if(this._socket.destroyed){const e=new Error("The socket was closed while data was being compressed");"function"==typeof n&&n(e);for(let t=0;t<this._queue.length;t++){const r=this._queue[t][4];"function"==typeof r&&r(e)}}else this._bufferedBytes-=e.length,this._deflating=!1,r.readOnly=!1,this.sendFrame(f.frame(o,r),n),this.dequeue()}))}dequeue(){for(;!this._deflating&&this._queue.length;){const e=this._queue.shift();this._bufferedBytes-=e[1].length,Reflect.apply(e[0],this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[1].length,this._queue.push(e)}sendFrame(e,t){2===e.length?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],t),this._socket.uncork()):this._socket.write(e[0],t)}}e.exports=f},404:(e,t,r)=>{"use strict";const{Duplex:n}=r(2413);function o(e){e.emit("close")}function s(){!this.destroyed&&this._writableState.finished&&this.destroy()}function i(e){this.removeListener("error",i),this.destroy(),0===this.listenerCount("error")&&this.emit("error",e)}e.exports=function(e,t){let r=!0;function a(){r&&e._socket.resume()}e.readyState===e.CONNECTING?e.once("open",(function(){e._receiver.removeAllListeners("drain"),e._receiver.on("drain",a)})):(e._receiver.removeAllListeners("drain"),e._receiver.on("drain",a));const c=new n({...t,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return e.on("message",(function(t){c.push(t)||(r=!1,e._socket.pause())})),e.once("error",(function(e){c.destroyed||c.destroy(e)})),e.once("close",(function(){c.destroyed||c.push(null)})),c._destroy=function(t,r){if(e.readyState===e.CLOSED)return r(t),void process.nextTick(o,c);let n=!1;e.once("error",(function(e){n=!0,r(e)})),e.once("close",(function(){n||r(t),process.nextTick(o,c)})),e.terminate()},c._final=function(t){e.readyState!==e.CONNECTING?null!==e._socket&&(e._socket._writableState.finished?(t(),c._readableState.endEmitted&&c.destroy()):(e._socket.once("finish",(function(){t()})),e.close())):e.once("open",(function(){c._final(t)}))},c._read=function(){e.readyState!==e.OPEN||r||(r=!0,e._receiver._writableState.needDrain||e._socket.resume())},c._write=function(t,r,n){e.readyState!==e.CONNECTING?e.send(t,n):e.once("open",(function(){c._write(t,r,n)}))},c.on("end",s),c.on("error",i),c}},6746:(e,t,r)=>{"use strict";try{const e=r(Object(function(){var e=new Error("Cannot find module 'utf-8-validate'");throw e.code="MODULE_NOT_FOUND",e}()));t.isValidUTF8="object"==typeof e?e.Validation.isValidUTF8:e}catch(e){t.isValidUTF8=()=>!0}t.isValidStatusCode=e=>e>=1e3&&e<=1014&&1004!==e&&1005!==e&&1006!==e||e>=3e3&&e<=4999},9284:(e,t,r)=>{"use strict";const n=r(8614),{createHash:o}=r(6417),{createServer:s,STATUS_CODES:i}=r(8605),a=r(5196),c=r(8762),{format:l,parse:f}=r(1503),{GUID:h,kWebSocket:u}=r(1872),d=/^[+/0-9A-Za-z]{22}==$/;function p(e){e.emit("close")}function m(){this.destroy()}function g(e,t,r,n){e.writable&&(r=r||i[t],n={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(r),...n},e.write(`HTTP/1.1 ${t} ${i[t]}\r\n`+Object.keys(n).map((e=>`${e}: ${n[e]}`)).join("\r\n")+"\r\n\r\n"+r)),e.removeListener("error",m),e.destroy()}e.exports=class extends n{constructor(e,t){if(super(),null==(e={maxPayload:104857600,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,...e}).port&&!e.server&&!e.noServer)throw new TypeError('One of the "port", "server", or "noServer" options must be specified');null!=e.port?(this._server=s(((e,t)=>{const r=i[426];t.writeHead(426,{"Content-Length":r.length,"Content-Type":"text/plain"}),t.end(r)})),this._server.listen(e.port,e.host,e.backlog,t)):e.server&&(this._server=e.server),this._server&&(this._removeListeners=function(e,t){for(const r of Object.keys(t))e.on(r,t[r]);return function(){for(const r of Object.keys(t))e.removeListener(r,t[r])}}(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(e,t,r)=>{this.handleUpgrade(e,t,r,(t=>{this.emit("connection",t,e)}))}})),!0===e.perMessageDeflate&&(e.perMessageDeflate={}),e.clientTracking&&(this.clients=new Set),this.options=e}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(e){if(e&&this.once("close",e),this.clients)for(const e of this.clients)e.terminate();const t=this._server;t&&(this._removeListeners(),this._removeListeners=this._server=null,null!=this.options.port)?t.close((()=>this.emit("close"))):process.nextTick(p,this)}shouldHandle(e){if(this.options.path){const t=e.url.indexOf("?");if((-1!==t?e.url.slice(0,t):e.url)!==this.options.path)return!1}return!0}handleUpgrade(e,t,r,n){t.on("error",m);const o=void 0!==e.headers["sec-websocket-key"]&&e.headers["sec-websocket-key"].trim(),s=+e.headers["sec-websocket-version"],i={};if("GET"!==e.method||"websocket"!==e.headers.upgrade.toLowerCase()||!o||!d.test(o)||8!==s&&13!==s||!this.shouldHandle(e))return g(t,400);if(this.options.perMessageDeflate){const r=new a(this.options.perMessageDeflate,!0,this.options.maxPayload);try{const t=f(e.headers["sec-websocket-extensions"]);t[a.extensionName]&&(r.accept(t[a.extensionName]),i[a.extensionName]=r)}catch(e){return g(t,400)}}if(this.options.verifyClient){const a={origin:e.headers[8===s?"sec-websocket-origin":"origin"],secure:!(!e.connection.authorized&&!e.connection.encrypted),req:e};if(2===this.options.verifyClient.length)return void this.options.verifyClient(a,((s,a,c,l)=>{if(!s)return g(t,a||401,c,l);this.completeUpgrade(o,i,e,t,r,n)}));if(!this.options.verifyClient(a))return g(t,401)}this.completeUpgrade(o,i,e,t,r,n)}completeUpgrade(e,t,r,n,s,i){if(!n.readable||!n.writable)return n.destroy();if(n[u])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");const f=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade","Sec-WebSocket-Accept: "+o("sha1").update(e+h).digest("base64")],d=new c(null);let p=r.headers["sec-websocket-protocol"];if(p&&(p=p.trim().split(/ *, */),p=this.options.handleProtocols?this.options.handleProtocols(p,r):p[0],p&&(f.push("Sec-WebSocket-Protocol: "+p),d.protocol=p)),t[a.extensionName]){const e=t[a.extensionName].params,r=l({[a.extensionName]:[e]});f.push("Sec-WebSocket-Extensions: "+r),d._extensions=t}this.emit("headers",f,r),n.write(f.concat("\r\n").join("\r\n")),n.removeListener("error",m),d.setSocket(n,s,this.options.maxPayload),this.clients&&(this.clients.add(d),d.on("close",(()=>this.clients.delete(d)))),i(d)}}},8762:(e,t,r)=>{"use strict";const n=r(8614),o=r(7211),s=r(8605),i=r(1631),a=r(4016),{randomBytes:c,createHash:l}=r(6417),{URL:f}=r(8835),h=r(5196),u=r(2957),d=r(7330),{BINARY_TYPES:p,EMPTY_BUFFER:m,GUID:g,kStatusCode:y,kWebSocket:_,NOOP:E}=r(1872),{addEventListener:b,removeEventListener:v}=r(62),{format:w,parse:S}=r(1503),{toBuffer:C}=r(977),N=["CONNECTING","OPEN","CLOSING","CLOSED"],L=[8,13];class I extends n{constructor(e,t,r){super(),this.readyState=I.CONNECTING,this.protocol="",this._binaryType=p[0],this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage="",this._closeTimer=null,this._closeCode=1006,this._extensions={},this._receiver=null,this._sender=null,this._socket=null,null!==e?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,Array.isArray(t)?t=t.join(", "):"object"==typeof t&&null!==t&&(r=t,t=void 0),x(this,e,t,r)):this._isServer=!0}get CONNECTING(){return I.CONNECTING}get CLOSING(){return I.CLOSING}get CLOSED(){return I.CLOSED}get OPEN(){return I.OPEN}get binaryType(){return this._binaryType}set binaryType(e){p.includes(e)&&(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}setSocket(e,t,r){const n=new u(this._binaryType,this._extensions,this._isServer,r);this._sender=new d(e,this._extensions),this._receiver=n,this._socket=e,n[_]=this,e[_]=this,n.on("conclude",B),n.on("drain",U),n.on("error",F),n.on("message",P),n.on("ping",A),n.on("pong",M),e.setTimeout(0),e.setNoDelay(),t.length>0&&e.unshift(t),e.on("close",j),e.on("data",H),e.on("end",z),e.on("error",Z),this.readyState=I.OPEN,this.emit("open")}emitClose(){if(!this._socket)return this.readyState=I.CLOSED,void this.emit("close",this._closeCode,this._closeMessage);this._extensions[h.extensionName]&&this._extensions[h.extensionName].cleanup(),this._receiver.removeAllListeners(),this.readyState=I.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(e,t){if(this.readyState!==I.CLOSED){if(this.readyState===I.CONNECTING){const e="WebSocket was closed before the connection was established";return T(this,this._req,e)}this.readyState!==I.CLOSING?(this.readyState=I.CLOSING,this._sender.close(e,t,!this._isServer,(e=>{e||(this._closeFrameSent=!0,this._closeFrameReceived&&this._socket.end())})),this._closeTimer=setTimeout(this._socket.destroy.bind(this._socket),3e4)):this._closeFrameSent&&this._closeFrameReceived&&this._socket.end()}}ping(e,t,r){if(this.readyState===I.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof e?(r=e,e=t=void 0):"function"==typeof t&&(r=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState===I.OPEN?(void 0===t&&(t=!this._isServer),this._sender.ping(e||m,t,r)):k(this,e,r)}pong(e,t,r){if(this.readyState===I.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof e?(r=e,e=t=void 0):"function"==typeof t&&(r=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState===I.OPEN?(void 0===t&&(t=!this._isServer),this._sender.pong(e||m,t,r)):k(this,e,r)}send(e,t,r){if(this.readyState===I.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof t&&(r=t,t={}),"number"==typeof e&&(e=e.toString()),this.readyState!==I.OPEN)return void k(this,e,r);const n={binary:"string"!=typeof e,mask:!this._isServer,compress:!0,fin:!0,...t};this._extensions[h.extensionName]||(n.compress=!1),this._sender.send(e||m,n,r)}terminate(){if(this.readyState!==I.CLOSED){if(this.readyState===I.CONNECTING){const e="WebSocket was closed before the connection was established";return T(this,this._req,e)}this._socket&&(this.readyState=I.CLOSING,this._socket.destroy())}}}function x(e,t,r,n){const i={protocolVersion:L[1],maxPayload:104857600,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...n,createConnection:void 0,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:void 0,host:void 0,path:void 0,port:void 0};if(!L.includes(i.protocolVersion))throw new RangeError(`Unsupported protocol version: ${i.protocolVersion} (supported versions: ${L.join(", ")})`);let a;t instanceof f?(a=t,e.url=t.href):(a=new f(t),e.url=t);const u="ws+unix:"===a.protocol;if(!(a.host||u&&a.pathname))throw new Error("Invalid URL: "+e.url);const d="wss:"===a.protocol||"https:"===a.protocol,p=d?443:80,m=c(16).toString("base64"),y=d?o.get:s.get;let _;if(i.createConnection=d?D:O,i.defaultPort=i.defaultPort||p,i.port=a.port||p,i.host=a.hostname.startsWith("[")?a.hostname.slice(1,-1):a.hostname,i.headers={"Sec-WebSocket-Version":i.protocolVersion,"Sec-WebSocket-Key":m,Connection:"Upgrade",Upgrade:"websocket",...i.headers},i.path=a.pathname+a.search,i.timeout=i.handshakeTimeout,i.perMessageDeflate&&(_=new h(!0!==i.perMessageDeflate?i.perMessageDeflate:{},!1,i.maxPayload),i.headers["Sec-WebSocket-Extensions"]=w({[h.extensionName]:_.offer()})),r&&(i.headers["Sec-WebSocket-Protocol"]=r),i.origin&&(i.protocolVersion<13?i.headers["Sec-WebSocket-Origin"]=i.origin:i.headers.Origin=i.origin),(a.username||a.password)&&(i.auth=`${a.username}:${a.password}`),u){const e=i.path.split(":");i.socketPath=e[0],i.path=e[1]}let E=e._req=y(i);i.timeout&&E.on("timeout",(()=>{T(e,E,"Opening handshake has timed out")})),E.on("error",(t=>{e._req.aborted||(E=e._req=null,e.readyState=I.CLOSING,e.emit("error",t),e.emitClose())})),E.on("response",(o=>{const s=o.headers.location,a=o.statusCode;if(s&&i.followRedirects&&a>=300&&a<400){if(++e._redirects>i.maxRedirects)return void T(e,E,"Maximum redirects exceeded");E.abort();const o=new f(s,t);x(e,o,r,n)}else e.emit("unexpected-response",E,o)||T(e,E,"Unexpected server response: "+o.statusCode)})),E.on("upgrade",((t,n,o)=>{if(e.emit("upgrade",t),e.readyState!==I.CONNECTING)return;E=e._req=null;const s=l("sha1").update(m+g).digest("base64");if(t.headers["sec-websocket-accept"]!==s)return void T(e,n,"Invalid Sec-WebSocket-Accept header");const a=t.headers["sec-websocket-protocol"],c=(r||"").split(/, */);let f;if(!r&&a?f="Server sent a subprotocol but none was requested":r&&!a?f="Server sent no subprotocol":a&&!c.includes(a)&&(f="Server sent an invalid subprotocol"),f)T(e,n,f);else{if(a&&(e.protocol=a),_)try{const r=S(t.headers["sec-websocket-extensions"]);r[h.extensionName]&&(_.accept(r[h.extensionName]),e._extensions[h.extensionName]=_)}catch(t){return void T(e,n,"Invalid Sec-WebSocket-Extensions header")}e.setSocket(n,o,i.maxPayload)}}))}function O(e){return e.path=e.socketPath,i.connect(e)}function D(e){return e.path=void 0,e.servername||""===e.servername||(e.servername=e.host),a.connect(e)}function T(e,t,r){e.readyState=I.CLOSING;const n=new Error(r);Error.captureStackTrace(n,T),t.setHeader?(t.abort(),t.once("abort",e.emitClose.bind(e)),e.emit("error",n)):(t.destroy(n),t.once("error",e.emit.bind(e,"error")),t.once("close",e.emitClose.bind(e)))}function k(e,t,r){if(t){const r=C(t).length;e._socket?e._sender._bufferedBytes+=r:e._bufferedAmount+=r}r&&r(new Error(`WebSocket is not open: readyState ${e.readyState} (${N[e.readyState]})`))}function B(e,t){const r=this[_];r._socket.removeListener("data",H),r._socket.resume(),r._closeFrameReceived=!0,r._closeMessage=t,r._closeCode=e,1005===e?r.close():r.close(e,t)}function U(){this[_]._socket.resume()}function F(e){const t=this[_];t._socket.removeListener("data",H),t.readyState=I.CLOSING,t._closeCode=e[y],t.emit("error",e),t._socket.destroy()}function R(){this[_].emitClose()}function P(e){this[_].emit("message",e)}function A(e){const t=this[_];t.pong(e,!t._isServer,E),t.emit("ping",e)}function M(e){this[_].emit("pong",e)}function j(){const e=this[_];this.removeListener("close",j),this.removeListener("end",z),e.readyState=I.CLOSING,e._socket.read(),e._receiver.end(),this.removeListener("data",H),this[_]=void 0,clearTimeout(e._closeTimer),e._receiver._writableState.finished||e._receiver._writableState.errorEmitted?e.emitClose():(e._receiver.on("error",R),e._receiver.on("finish",R))}function H(e){this[_]._receiver.write(e)||this.pause()}function z(){const e=this[_];e.readyState=I.CLOSING,e._receiver.end(),this.end()}function Z(){const e=this[_];this.removeListener("error",Z),this.on("error",E),e&&(e.readyState=I.CLOSING,this.destroy())}N.forEach(((e,t)=>{I[e]=t})),["open","error","close","message"].forEach((e=>{Object.defineProperty(I.prototype,"on"+e,{get(){const t=this.listeners(e);for(let e=0;e<t.length;e++)if(t[e]._listener)return t[e]._listener},set(t){const r=this.listeners(e);for(let t=0;t<r.length;t++)r[t]._listener&&this.removeListener(e,r[t]);this.addEventListener(e,t)}})})),I.prototype.addEventListener=b,I.prototype.removeEventListener=v,e.exports=I},2357:e=>{"use strict";e.exports=require("assert")},3129:e=>{"use strict";e.exports=require("child_process")},6417:e=>{"use strict";e.exports=require("crypto")},8614:e=>{"use strict";e.exports=require("events")},5747:e=>{"use strict";e.exports=require("fs")},8605:e=>{"use strict";e.exports=require("http")},7211:e=>{"use strict";e.exports=require("https")},1631:e=>{"use strict";e.exports=require("net")},2087:e=>{"use strict";e.exports=require("os")},5622:e=>{"use strict";e.exports=require("path")},2413:e=>{"use strict";e.exports=require("stream")},4016:e=>{"use strict";e.exports=require("tls")},3867:e=>{"use strict";e.exports=require("tty")},8835:e=>{"use strict";e.exports=require("url")},1669:e=>{"use strict";e.exports=require("util")},8761:e=>{"use strict";e.exports=require("zlib")}},r={};function n(e){if(r[e])return r[e].exports;var o=r[e]={exports:{}};return t[e].call(o.exports,o,o.exports,n),o.exports}n.m=t,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.t=function(e,t){if(1&t&&(e=this(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);n.r(r);var o={};if(2&t&&"object"==typeof e&&e)for(const t in e)o[t]=()=>e[t];return o.default=()=>e,n.d(r,o),r},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,r)=>(n.f[r](e,t),t)),[])),n.u=e=>e+".grader.js",n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},e={179:1},n.f.require=function(t,r){e[t]||(t=>{var r=t.modules,o=t.ids,s=t.runtime;for(var i in r)n.o(r,i)&&(n.m[i]=r[i]);s&&s(n);for(var a=0;a<o.length;a++)e[o[a]]=1})(require("./"+n.u(t)))},(()=>{"use strict";var e=n(3129),t=n(5285),r=n.n(t),o=n(5747),s=n.n(o),i=n(5622),a=n.n(i),c=n(2087),l=n.n(c);const f=process.env.PORT||process.argv[2]||22121,h=process.argv[3]||8222,u={},d=a().resolve(l().homedir(),".grader.config.json"),p=Math.random().toString("36");!function(){if(s().existsSync(d))try{Object.assign(u,JSON.parse(s().readFileSync(d)))}catch(e){console.warn("Error reading from preferences file",e)}else console.log("Preferences file does not exist. Creating one..."),_()}();let m=u.BasePath;console.log("Args usage: <server_port> <chrome_port> <... other args>"),y(process.argv[5]||u.BasePath||l().homedir());const g={server_port:f,chrome_port:h,updateBasePath:y,getBasePath:function(){return m},temp_browser_cache:()=>a().resolve(l().homedir(),".temp-browser-cache"+p),app_data_dir:()=>a().resolve(l().homedir(),".app-data")};function y(e){return e=a().resolve(e),m!=e&&(console.log(`Updating base path from ${m} to ${e}...`),m=e,console.log(`Base path updated to: ${m}. Saving to preferences...`),u.BasePath=m,_(),console.log("Saved!"),!0)}function _(){try{s().writeFileSync(d,JSON.stringify(u))}catch(e){console.warn("Error writing preferences file",d,u,e)}}var E=n(2413),b=n(8605),v=n(8835),w=n(7211),S=n(8761);const C=E.Readable,N=Symbol("buffer"),L=Symbol("type");class I{constructor(){this[L]="";const e=arguments[0],t=arguments[1],r=[];let n=0;if(e){const t=e,o=Number(t.length);for(let e=0;e<o;e++){const o=t[e];let s;s=o instanceof Buffer?o:ArrayBuffer.isView(o)?Buffer.from(o.buffer,o.byteOffset,o.byteLength):o instanceof ArrayBuffer?Buffer.from(o):o instanceof I?o[N]:Buffer.from("string"==typeof o?o:String(o)),n+=s.length,r.push(s)}}this[N]=Buffer.concat(r);let o=t&&void 0!==t.type&&String(t.type).toLowerCase();o&&!/[^\u0020-\u007E]/.test(o)&&(this[L]=o)}get size(){return this[N].length}get type(){return this[L]}text(){return Promise.resolve(this[N].toString())}arrayBuffer(){const e=this[N],t=e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);return Promise.resolve(t)}stream(){const e=new C;return e._read=function(){},e.push(this[N]),e.push(null),e}toString(){return"[object Blob]"}slice(){const e=this.size,t=arguments[0],r=arguments[1];let n,o;n=void 0===t?0:t<0?Math.max(e+t,0):Math.min(t,e),o=void 0===r?e:r<0?Math.max(e+r,0):Math.min(r,e);const s=Math.max(o-n,0),i=this[N].slice(n,n+s),a=new I([],{type:arguments[2]});return a[N]=i,a}}function x(e,t,r){Error.call(this,e),this.message=e,this.type=t,r&&(this.code=this.errno=r.code),Error.captureStackTrace(this,this.constructor)}let O;Object.defineProperties(I.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}}),Object.defineProperty(I.prototype,Symbol.toStringTag,{value:"Blob",writable:!1,enumerable:!1,configurable:!0}),x.prototype=Object.create(Error.prototype),x.prototype.constructor=x,x.prototype.name="FetchError";try{O=require("encoding").convert}catch(e){}const D=Symbol("Body internals"),T=E.PassThrough;function k(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.size;let o=void 0===n?0:n;var s=r.timeout;let i=void 0===s?0:s;null==e?e=null:U(e)?e=Buffer.from(e.toString()):F(e)||Buffer.isBuffer(e)||("[object ArrayBuffer]"===Object.prototype.toString.call(e)?e=Buffer.from(e):ArrayBuffer.isView(e)?e=Buffer.from(e.buffer,e.byteOffset,e.byteLength):e instanceof E||(e=Buffer.from(String(e)))),this[D]={body:e,disturbed:!1,error:null},this.size=o,this.timeout=i,e instanceof E&&e.on("error",(function(e){const r="AbortError"===e.name?e:new x(`Invalid response body while trying to fetch ${t.url}: ${e.message}`,"system",e);t[D].error=r}))}function B(){var e=this;if(this[D].disturbed)return k.Promise.reject(new TypeError("body used already for: "+this.url));if(this[D].disturbed=!0,this[D].error)return k.Promise.reject(this[D].error);let t=this.body;if(null===t)return k.Promise.resolve(Buffer.alloc(0));if(F(t)&&(t=t.stream()),Buffer.isBuffer(t))return k.Promise.resolve(t);if(!(t instanceof E))return k.Promise.resolve(Buffer.alloc(0));let r=[],n=0,o=!1;return new k.Promise((function(s,i){let a;e.timeout&&(a=setTimeout((function(){o=!0,i(new x(`Response timeout while trying to fetch ${e.url} (over ${e.timeout}ms)`,"body-timeout"))}),e.timeout)),t.on("error",(function(t){"AbortError"===t.name?(o=!0,i(t)):i(new x(`Invalid response body while trying to fetch ${e.url}: ${t.message}`,"system",t))})),t.on("data",(function(t){if(!o&&null!==t){if(e.size&&n+t.length>e.size)return o=!0,void i(new x(`content size at ${e.url} over limit: ${e.size}`,"max-size"));n+=t.length,r.push(t)}})),t.on("end",(function(){if(!o){clearTimeout(a);try{s(Buffer.concat(r,n))}catch(t){i(new x(`Could not create Buffer from response body for ${e.url}: ${t.message}`,"system",t))}}}))}))}function U(e){return"object"==typeof e&&"function"==typeof e.append&&"function"==typeof e.delete&&"function"==typeof e.get&&"function"==typeof e.getAll&&"function"==typeof e.has&&"function"==typeof e.set&&("URLSearchParams"===e.constructor.name||"[object URLSearchParams]"===Object.prototype.toString.call(e)||"function"==typeof e.sort)}function F(e){return"object"==typeof e&&"function"==typeof e.arrayBuffer&&"string"==typeof e.type&&"function"==typeof e.stream&&"function"==typeof e.constructor&&"string"==typeof e.constructor.name&&/^(Blob|File)$/.test(e.constructor.name)&&/^(Blob|File)$/.test(e[Symbol.toStringTag])}function R(e){let t,r,n=e.body;if(e.bodyUsed)throw new Error("cannot clone body after it is used");return n instanceof E&&"function"!=typeof n.getBoundary&&(t=new T,r=new T,n.pipe(t),n.pipe(r),e[D].body=t,n=r),n}function P(e){return null===e?null:"string"==typeof e?"text/plain;charset=UTF-8":U(e)?"application/x-www-form-urlencoded;charset=UTF-8":F(e)?e.type||null:Buffer.isBuffer(e)||"[object ArrayBuffer]"===Object.prototype.toString.call(e)||ArrayBuffer.isView(e)?null:"function"==typeof e.getBoundary?"multipart/form-data;boundary="+e.getBoundary():e instanceof E?null:"text/plain;charset=UTF-8"}function A(e){const t=e.body;return null===t?0:F(t)?t.size:Buffer.isBuffer(t)?t.length:t&&"function"==typeof t.getLengthSync&&(t._lengthRetrievers&&0==t._lengthRetrievers.length||t.hasKnownLength&&t.hasKnownLength())?t.getLengthSync():null}k.prototype={get body(){return this[D].body},get bodyUsed(){return this[D].disturbed},arrayBuffer(){return B.call(this).then((function(e){return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}))},blob(){let e=this.headers&&this.headers.get("content-type")||"";return B.call(this).then((function(t){return Object.assign(new I([],{type:e.toLowerCase()}),{[N]:t})}))},json(){var e=this;return B.call(this).then((function(t){try{return JSON.parse(t.toString())}catch(t){return k.Promise.reject(new x(`invalid json response body at ${e.url} reason: ${t.message}`,"invalid-json"))}}))},text(){return B.call(this).then((function(e){return e.toString()}))},buffer(){return B.call(this)},textConverted(){var e=this;return B.call(this).then((function(t){return function(e,t){if("function"!=typeof O)throw new Error("The package `encoding` must be installed to use the textConverted() function");const r=t.get("content-type");let n,o,s="utf-8";return r&&(n=/charset=([^;]*)/i.exec(r)),o=e.slice(0,1024).toString(),!n&&o&&(n=/<meta.+?charset=(['"])(.+?)\1/i.exec(o)),!n&&o&&(n=/<meta[\s]+?http-equiv=(['"])content-type\1[\s]+?content=(['"])(.+?)\2/i.exec(o),n||(n=/<meta[\s]+?content=(['"])(.+?)\1[\s]+?http-equiv=(['"])content-type\3/i.exec(o),n&&n.pop()),n&&(n=/charset=(.*)/i.exec(n.pop()))),!n&&o&&(n=/<\?xml.+?encoding=(['"])(.+?)\1/i.exec(o)),n&&(s=n.pop(),"gb2312"!==s&&"gbk"!==s||(s="gb18030")),O(e,"UTF-8",s).toString()}(t,e.headers)}))}},Object.defineProperties(k.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0}}),k.mixIn=function(e){for(const t of Object.getOwnPropertyNames(k.prototype))if(!(t in e)){const r=Object.getOwnPropertyDescriptor(k.prototype,t);Object.defineProperty(e,t,r)}},k.Promise=global.Promise;const M=/[^\^_`a-zA-Z\-0-9!#$%&'*+.|~]/,j=/[^\t\x20-\x7e\x80-\xff]/;function H(e){if(e=""+e,M.test(e)||""===e)throw new TypeError(e+" is not a legal HTTP header name")}function z(e){if(e=""+e,j.test(e))throw new TypeError(e+" is not a legal HTTP header value")}function Z(e,t){t=t.toLowerCase();for(const r in e)if(r.toLowerCase()===t)return r}const G=Symbol("map");class W{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;if(this[G]=Object.create(null),e instanceof W){const t=e.raw(),r=Object.keys(t);for(const e of r)for(const r of t[e])this.append(e,r)}else if(null==e);else{if("object"!=typeof e)throw new TypeError("Provided initializer must be an object");{const t=e[Symbol.iterator];if(null!=t){if("function"!=typeof t)throw new TypeError("Header pairs must be iterable");const r=[];for(const t of e){if("object"!=typeof t||"function"!=typeof t[Symbol.iterator])throw new TypeError("Each header pair must be iterable");r.push(Array.from(t))}for(const e of r){if(2!==e.length)throw new TypeError("Each header pair must be a name/value tuple");this.append(e[0],e[1])}}else for(const t of Object.keys(e)){const r=e[t];this.append(t,r)}}}}get(e){H(e=""+e);const t=Z(this[G],e);return void 0===t?null:this[G][t].join(", ")}forEach(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,r=q(this),n=0;for(;n<r.length;){var o=r[n];const s=o[0],i=o[1];e.call(t,i,s,this),r=q(this),n++}}set(e,t){t=""+t,H(e=""+e),z(t);const r=Z(this[G],e);this[G][void 0!==r?r:e]=[t]}append(e,t){t=""+t,H(e=""+e),z(t);const r=Z(this[G],e);void 0!==r?this[G][r].push(t):this[G][e]=[t]}has(e){return H(e=""+e),void 0!==Z(this[G],e)}delete(e){H(e=""+e);const t=Z(this[G],e);void 0!==t&&delete this[G][t]}raw(){return this[G]}keys(){return $(this,"key")}values(){return $(this,"value")}[Symbol.iterator](){return $(this,"key+value")}}function q(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"key+value";const r=Object.keys(e[G]).sort();return r.map("key"===t?function(e){return e.toLowerCase()}:"value"===t?function(t){return e[G][t].join(", ")}:function(t){return[t.toLowerCase(),e[G][t].join(", ")]})}W.prototype.entries=W.prototype[Symbol.iterator],Object.defineProperty(W.prototype,Symbol.toStringTag,{value:"Headers",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(W.prototype,{get:{enumerable:!0},forEach:{enumerable:!0},set:{enumerable:!0},append:{enumerable:!0},has:{enumerable:!0},delete:{enumerable:!0},keys:{enumerable:!0},values:{enumerable:!0},entries:{enumerable:!0}});const V=Symbol("internal");function $(e,t){const r=Object.create(X);return r[V]={target:e,kind:t,index:0},r}const X=Object.setPrototypeOf({next(){if(!this||Object.getPrototypeOf(this)!==X)throw new TypeError("Value of `this` is not a HeadersIterator");var e=this[V];const t=e.target,r=e.kind,n=e.index,o=q(t,r);return n>=o.length?{value:void 0,done:!0}:(this[V].index=n+1,{value:o[n],done:!1})}},Object.getPrototypeOf(Object.getPrototypeOf([][Symbol.iterator]())));function Y(e){const t=Object.assign({__proto__:null},e[G]),r=Z(e[G],"Host");return void 0!==r&&(t[r]=t[r][0]),t}Object.defineProperty(X,Symbol.toStringTag,{value:"HeadersIterator",writable:!1,enumerable:!1,configurable:!0});const K=Symbol("Response internals"),J=b.STATUS_CODES;class Q{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};k.call(this,e,t);const r=t.status||200,n=new W(t.headers);if(null!=e&&!n.has("Content-Type")){const t=P(e);t&&n.append("Content-Type",t)}this[K]={url:t.url,status:r,statusText:t.statusText||J[r],headers:n,counter:t.counter}}get url(){return this[K].url||""}get status(){return this[K].status}get ok(){return this[K].status>=200&&this[K].status<300}get redirected(){return this[K].counter>0}get statusText(){return this[K].statusText}get headers(){return this[K].headers}clone(){return new Q(R(this),{url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected})}}k.mixIn(Q.prototype),Object.defineProperties(Q.prototype,{url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}}),Object.defineProperty(Q.prototype,Symbol.toStringTag,{value:"Response",writable:!1,enumerable:!1,configurable:!0});const ee=Symbol("Request internals"),te=v.parse,re=v.format,ne="destroy"in E.Readable.prototype;function oe(e){return"object"==typeof e&&"object"==typeof e[ee]}class se{constructor(e){let t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};oe(e)?t=te(e.url):(t=e&&e.href?te(e.href):te(""+e),e={});let n=r.method||e.method||"GET";if(n=n.toUpperCase(),(null!=r.body||oe(e)&&null!==e.body)&&("GET"===n||"HEAD"===n))throw new TypeError("Request with GET/HEAD method cannot have body");let o=null!=r.body?r.body:oe(e)&&null!==e.body?R(e):null;k.call(this,o,{timeout:r.timeout||e.timeout||0,size:r.size||e.size||0});const s=new W(r.headers||e.headers||{});if(null!=o&&!s.has("Content-Type")){const e=P(o);e&&s.append("Content-Type",e)}let i=oe(e)?e.signal:null;if("signal"in r&&(i=r.signal),null!=i&&!function(e){const t=e&&"object"==typeof e&&Object.getPrototypeOf(e);return!(!t||"AbortSignal"!==t.constructor.name)}(i))throw new TypeError("Expected signal to be an instanceof AbortSignal");this[ee]={method:n,redirect:r.redirect||e.redirect||"follow",headers:s,parsedURL:t,signal:i},this.follow=void 0!==r.follow?r.follow:void 0!==e.follow?e.follow:20,this.compress=void 0!==r.compress?r.compress:void 0===e.compress||e.compress,this.counter=r.counter||e.counter||0,this.agent=r.agent||e.agent}get method(){return this[ee].method}get url(){return re(this[ee].parsedURL)}get headers(){return this[ee].headers}get redirect(){return this[ee].redirect}get signal(){return this[ee].signal}clone(){return new se(this)}}function ie(e){Error.call(this,e),this.type="aborted",this.message=e,Error.captureStackTrace(this,this.constructor)}k.mixIn(se.prototype),Object.defineProperty(se.prototype,Symbol.toStringTag,{value:"Request",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(se.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0}}),ie.prototype=Object.create(Error.prototype),ie.prototype.constructor=ie,ie.prototype.name="AbortError";const ae=E.PassThrough,ce=v.resolve;function le(e,t){if(!le.Promise)throw new Error("native promise missing, set fetch.Promise to your favorite alternative");return k.Promise=le.Promise,new le.Promise((function(r,n){const o=new se(e,t),s=function(e){const t=e[ee].parsedURL,r=new W(e[ee].headers);if(r.has("Accept")||r.set("Accept","*/*"),!t.protocol||!t.hostname)throw new TypeError("Only absolute URLs are supported");if(!/^https?:$/.test(t.protocol))throw new TypeError("Only HTTP(S) protocols are supported");if(e.signal&&e.body instanceof E.Readable&&!ne)throw new Error("Cancellation of streamed requests with AbortSignal is not supported in node < 8");let n=null;if(null==e.body&&/^(POST|PUT)$/i.test(e.method)&&(n="0"),null!=e.body){const t=A(e);"number"==typeof t&&(n=String(t))}n&&r.set("Content-Length",n),r.has("User-Agent")||r.set("User-Agent","node-fetch/1.0 (+https://github.com/bitinn/node-fetch)"),e.compress&&!r.has("Accept-Encoding")&&r.set("Accept-Encoding","gzip,deflate");let o=e.agent;return"function"==typeof o&&(o=o(t)),r.has("Connection")||o||r.set("Connection","close"),Object.assign({},t,{method:e.method,headers:Y(r),agent:o})}(o),i=("https:"===s.protocol?w:b).request,a=o.signal;let c=null;const l=function(){let e=new ie("The user aborted a request.");n(e),o.body&&o.body instanceof E.Readable&&o.body.destroy(e),c&&c.body&&c.body.emit("error",e)};if(a&&a.aborted)return void l();const f=function(){l(),d()},h=i(s);let u;function d(){h.abort(),a&&a.removeEventListener("abort",f),clearTimeout(u)}a&&a.addEventListener("abort",f),o.timeout&&h.once("socket",(function(e){u=setTimeout((function(){n(new x("network timeout at: "+o.url,"request-timeout")),d()}),o.timeout)})),h.on("error",(function(e){n(new x(`request to ${o.url} failed, reason: ${e.message}`,"system",e)),d()})),h.on("response",(function(e){clearTimeout(u);const t=function(e){const t=new W;for(const r of Object.keys(e))if(!M.test(r))if(Array.isArray(e[r]))for(const n of e[r])j.test(n)||(void 0===t[G][r]?t[G][r]=[n]:t[G][r].push(n));else j.test(e[r])||(t[G][r]=[e[r]]);return t}(e.headers);if(le.isRedirect(e.statusCode)){const s=t.get("Location"),i=null===s?null:ce(o.url,s);switch(o.redirect){case"error":return n(new x("uri requested responds with a redirect, redirect mode is set to error: "+o.url,"no-redirect")),void d();case"manual":if(null!==i)try{t.set("Location",i)}catch(e){n(e)}break;case"follow":if(null===i)break;if(o.counter>=o.follow)return n(new x("maximum redirect reached at: "+o.url,"max-redirect")),void d();const s={headers:new W(o.headers),follow:o.follow,counter:o.counter+1,agent:o.agent,compress:o.compress,method:o.method,body:o.body,signal:o.signal,timeout:o.timeout,size:o.size};return 303!==e.statusCode&&o.body&&null===A(o)?(n(new x("Cannot follow redirect with body being a readable stream","unsupported-redirect")),void d()):(303!==e.statusCode&&(301!==e.statusCode&&302!==e.statusCode||"POST"!==o.method)||(s.method="GET",s.body=void 0,s.headers.delete("content-length")),r(le(new se(i,s))),void d())}}e.once("end",(function(){a&&a.removeEventListener("abort",f)}));let s=e.pipe(new ae);const i={url:o.url,status:e.statusCode,statusText:e.statusMessage,headers:t,size:o.size,timeout:o.timeout,counter:o.counter},l=t.get("Content-Encoding");if(!o.compress||"HEAD"===o.method||null===l||204===e.statusCode||304===e.statusCode)return c=new Q(s,i),void r(c);const h={flush:S.Z_SYNC_FLUSH,finishFlush:S.Z_SYNC_FLUSH};if("gzip"==l||"x-gzip"==l)return s=s.pipe(S.createGunzip(h)),c=new Q(s,i),void r(c);if("deflate"!=l&&"x-deflate"!=l){if("br"==l&&"function"==typeof S.createBrotliDecompress)return s=s.pipe(S.createBrotliDecompress()),c=new Q(s,i),void r(c);c=new Q(s,i),r(c)}else e.pipe(new ae).once("data",(function(e){s=8==(15&e[0])?s.pipe(S.createInflate()):s.pipe(S.createInflateRaw()),c=new Q(s,i),r(c)}))})),function(e,t){const r=t.body;null===r?e.end():F(r)?r.stream().pipe(e):Buffer.isBuffer(r)?(e.write(r),e.end()):r.pipe(e)}(h,o)}))}le.isRedirect=function(e){return 301===e||302===e||303===e||307===e||308===e},le.Promise=global.Promise;const fe=le;var he=n(8777),ue=n.n(he);let de="unknown";!function(){try{return global&&global.Math}catch(e){return!1}}()?function(){try{return window&&window.fetch}catch(e){return!1}}()&&(de="browser",function(){try{return chrome.runtime&&chrome.debugger}catch(e){return!1}}()&&(de="extension")):de="node",process.env.DEBUG_grader;const pe=process.env.DEBUG_grader||!1,me=(__dirname,e=>new Promise((t=>setTimeout(t,e)))),ge="browser",{server_port:ye,chrome_port:_e}=g,Ee=pe?["--app=http://localhost:"+ye,"--restore-last-session","--disk-cache-dir="+g.temp_browser_cache(),"--aggressive-cache-discard","--no-sandbox"]:["--app=http://localhost:"+ye,"--restore-last-session","--disk-cache-dir="+g.temp_browser_cache(),"--aggressive-cache-discard"],be={logLevel:"verbose",port:_e,chromeFlags:Ee,userDataDir:g.app_data_dir(),ignoreDefaultFlags:!0};let ve;process.on("error",((...e)=>{console.log(e)})),async function(){console.log("Importing dependencies...");const{launch:t}=await n.e(12).then(n.t.bind(n,8012,7));let o;console.log("Removing grader's existing temporary browser cache if it exists..."),s().existsSync(g.temp_browser_cache())&&(console.log(`Temp browser cache directory (${g.temp_browser_cache()}) exists, deleting...`),s().rmdirSync(g.temp_browser_cache(),{recursive:!0}),console.log("Deleted.")),s().existsSync(g.app_data_dir())||(console.log("App data dir does not exist. Creating..."),s().mkdirSync(g.app_data_dir(),{recursive:!0}),console.log("Created.")),console.log("Launching app server...");try{o=s().readFileSync(a().resolve(__dirname,"..","build","app.zip"))}catch(e){console.log("src build server",e)}try{const t=a().resolve(l().homedir(),".grader_server_"+Math.random().toString(36)),n=a().resolve(t,"app.zip");s().mkdirSync(t,{recursive:!0}),s().writeFileSync(n,o),new(r())(n).extractAllTo(t);const i=a().resolve(t,"app","server.js"),c=(0,e.fork)(i,{windowsHide:!0,detached:!0,stdio:"ignore"});console.log(3,c),c.on("error",((...e)=>console.log(3,e)))}catch(e){console.log(e)}console.log("App server started."),console.log("Waiting 1 second..."),await me(1e3),console.log("Launching chrome..."),console.log({LAUNCH_OPTS:be});const i=await t(be);console.log({browser:i,ChromeLaunch:t}),console.log("Chrome started."),console.log("Waiting 1 second..."),await me(1e3),console.log("Connecting to chrome...");const c=await async function({port:e=9222}={}){try{const{webSocketDebuggerUrl:t}=await fe(`http://localhost:${e}/json/version`).then((e=>e.json())),r=new(ue())(t),n={},o={};r.on("message",(async function(e){const t=e;(e=JSON.parse(e)).error;const{sessionId:r}=e,{method:s,params:i}=e,{id:a,result:c}=e;if(a){const e=`${r||ge}:${a}`,o=n[e];if(o){n[e]=void 0;try{await o(c)}catch(r){console.warn("Resolver failed",r,e,t.slice(0,140),o)}}else console.warn("No resolver for key",e,t.slice(0,140))}else if(s){const n=o[s];if(Array.isArray(n))for(const o of n)try{o({message:e,sessionId:r})}catch(e){console.warn("Listener failed",s,e,o.toString().slice(0,140),t.slice(0,140))}}else console.warn("Unknown message on socket",e)}));let s,i=0;const a=new Promise((e=>s=e));return r.on("open",(()=>s())),await a,{send:async function(e,t={},o){const s={method:e,params:t,sessionId:o,id:++i};o||delete s[o];const a=`${o||ge}:${s.id}`;let c;const l=new Promise((e=>c=e));return n[a]=c,r.send(JSON.stringify(s)),l},on:function(e,t){let r=o[e];var n;r||(o[e]=r=[]),r.push((n=t,({message:e,sessionId:t})=>n(e.params)))},ons:function(e,t){let r=o[e];r||(o[e]=r=[]),r.push(t)},disconnect:function(){r.close()}}}catch(e){console.log("Error communicating with browser",e),process.exit(1)}}({port:_e});c.close=async()=>await i.kill(),ve=c,console.log("Ready"),await me(1e4)}()})()})();